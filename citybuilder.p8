pico-8 cartridge // http://www.pico-8.com
version 27
__lua__
--city builder
--by isaac dunn

function _init()
 game_state=0--main menu
 land_gen()
 init_main()
end

function _update()
 if game_state==0 then
  update_main()
 else
  
 end
end

function _draw()
 cls()
 map()
 if game_state==0 then
  draw_map()
  draw_main()
 else
  draw_map()
 end
end
-->8
--main menu

function init_main()
 main_cursorx=1
end

function update_main()
 if btnp(⬆️) and main_cursorx==2 then
  main_cursorx-=1
 elseif btnp(⬇️) and main_cursorx==1 then
  main_cursorx+=1
 elseif btnp(🅾️) then
  if main_cursorx==1 then
   new_game()
  else
   --load game
  end
 end
end

function draw_main()
 draw_button(24,40,"new game",7,48,46)
 draw_button(24,72,"load game",7,47,78)
 spr(16,3,main_cursorx*32+12)
 draw_logo(3,1)
end

function draw_button(offsetx,offsety
,txt,txt_colour,txt_x,txt_y)
 spr(32,0+offsetx,0+offsety)
 spr(34,0+offsetx,8+offsety)
 ui=0
 for ui_x=1,8 do
  spr(33,ui_x*8+offsetx,0+offsety)
  spr(33,ui_x*8+offsetx,8+offsety,1,1,0,1)
 end
 spr(34,72+offsetx,0+offsety,1,1,1,1)
 spr(32,72+offsetx,8+offsety,1,1,1,1)
 print(txt,txt_x,txt_y,txt_colour)
end

function draw_logo(offsetx,offsety)
 local x
 for x=0,9 do
  mset(x+offsetx,offsety,38+x)
  mset(x+offsetx,offsety+1,54+x)
 end
end 
-->8
--game data

function new_game()
 game_state=1
 land_gen()
end

function load_game()
end

function save_game()
end

function land_gen()
 noise_array={}
	local x
	local y
	for x=1,16 do
	 noise_array[x]={}
		for y=1,16 do
		 noise_array[x][y]=
		 static_noise_gen(15)
		end
	end
end

function draw_map()
 local x
	local y
 for x=1,16 do
  for y=1,16 do
   if noise_array[x][y]<9 then
		  mset(x-1,y-1,1)
		 elseif noise_array[x][y]<13 then
		 	mset(x-1,y-1,2)
		 elseif noise_array[x][y]<14 then
		 	mset(x-1,y-1,3)
		 elseif noise_array[x][y]<15 then
		 	mset(x-1,y-1,4)
		 end
		end
	end
end

function static_noise_gen(maxn)
 noise=rnd(maxn)
 return noise
end
__gfx__
000000003333b3333333333333336333333333330000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000003b333333333bb3333336663333cccc330000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700b333383333bbbb33334445333cccdcc30000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0007700033338b833bbbbbb3344445533ddcccc30000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0007700033333833bbbbbbbb344444533cccccc30000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0070070033a333b33bbbbbb3444444553ccddcc30000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000003aba333b333bb3334444445533cccc330000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000033a33b333333333333444433333333330000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
66000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
66660000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
65566600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
65555666000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
65555666000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
65566600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
66660000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
66000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
77777777777777777655555500000000000000000000000033000dddddddd000000000aaa000000000000cc0000000000008880000000880000000eeee000033
766666666666666676555555000000000000000000000000300ddddddddddd0000000aaaaa00000000000cc00000000000008880000088000000eeeeeee00003
76555555555555557655555500000000000000000000000000ddddddd0dddd0000000aaaa000000000000cc00000000000000880000888000000ee0000ee0000
76555555555555557655555500000000000000000000000000ddd0000000d000000000000000000000000cc0000000000000088800088800000ee000000e0000
76555555555555557655555500000000000000000000000000dd000000000000000000000000000000000cccccc0000000000088808888000000ee0000ee0000
76555555555555557655555500000000000000000000000000dd000000000000000000aa0000000000000cccccc00000000000888888800000000ee000ee0000
76555555555555557666666600000000000000000000000000dd000000000000000000aa000000000000ccc0000000000000000008880000000000eeeee00000
76555555555555557777777700000000000000000000000000ddd00000000000000000aa0000000000000ccc00000000000000008888000000000ee000ee0000
000000000000000000000000000000000000000000000000000ddd0000000000000000aaa000000000000ccc0000000000000008888000000000ee00000ee000
000000000000000000000000000000000000000000000000000dddd0000ddd000000000aaa000000000000ccc000000000000088888000000000ee0000eee000
0000000000000000000000000000000000000000000000000000ddddddddd0000000000aaa0000000000000ccc000000000008888800000000000eeeeee00000
000000000000000000000000000000000000000000000000000000ddddd0000000000000aaa0000000000000ccc000000000088800000000000000eeee000000
00000000000000000000000000000000000000000000000055555555555555555555555555555555555555555555555555555555555555555555555555555555
00000000000000000000000000000000000000000000000055555555555555555555555555555555555555555555555555555555555555555555555555555555
00000000000000000000000000000000000000000000000037757757757757757757757757757757757757757757757757757757757757757757757757757753
00000000000000000000000000000000000000000000000033555555555555555555555555555555555555555555555555555555555555555555555555555533
__map__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000efefefefefefefefefefef000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000002021212121212121212200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000003031313131313131313200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000002021212121212121212200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000003031313131313131313200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
